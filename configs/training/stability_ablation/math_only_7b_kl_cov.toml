model_name = "deepseek-ai/DeepSeek-R1-Distill-Qwen-7B"
project = "math-ablation"

collate_mode = "packing"
logprob_mode = "infer_model"

[train]
micro_bs = 2
reshard_after_forward = true
ac_ckpt = true

[data]
seq_length = 8192
path = "data_rollout"

[optim]
warmup_steps = 1
batch_size = 2048
total_steps = 10000000000000000000
step_per_rollout = 1

[grpo]
entropy_loss_coeff = 0

[grpo.loss]
type = "kl_cov"

[optim.optim]
lr = 1e-6

[ckpt]
rollout_path = "outputs"
clean_rollout_path = true